<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Football Registration</title>
  <style>
    body { font-family: Arial; max-width: 800px; margin: auto; padding: 20px; }
    select, button { margin: 10px 0; width: 100%; padding: 8px; font-size: 1rem; }
    ul { list-style: none; padding-left: 0; }
    li { padding: 8px; background: #eef; margin: 5px 0; border-radius: 4px; }
  </style>
</head>
<body>
  <h1>Football Teams Lookup</h1>

  <label>Country:</label>
  <select id="country"></select>

  <label>Province/State:</label>
  <select id="province"></select>

  <label>District:</label>
  <select id="district"></select>

  <label>Tehsil:</label>
  <select id="tehsil"></select>

  <button id="search">Search Teams</button>

  <h2>Teams:</h2>
  <ul id="teams-list"></ul>

  <script>
    const sheetId = '1wODunklSmhWV2WzgqgwDAjhJ26WmF0B_qNfteYmdUfU';
    const url = `https://opensheet.elk.sh/${sheetId}/Sheet1`;
    let dataRows = [];

    const countrySel = document.getElementById('country');
    const provSel = document.getElementById('province');
    const distSel = document.getElementById('district');
    const tehSel = document.getElementById('tehsil');
    const searchBtn = document.getElementById('search');
    const teamsList = document.getElementById('teams-list');

    // 1. Fetch Sheet Data
    fetch(url)
      .then(r => r.json())
      .then(rows => {
        dataRows = rows;
        populateDropdown(countrySel, getUnique(rows, 'Country\'s Name, the player belongs to ✅'));
      });

    // 2. Utility to extract unique values
    function getUnique(arr, col) {
      const s = new Set(arr.map(r => r[col]).filter(v => v));
      return Array.from(s).sort();
    }

    // 3. Populate dropdown
    function populateDropdown(sel, items) {
      sel.innerHTML = '<option value="">-- Select --</option>';
      items.forEach(v => {
        const o = document.createElement('option');
        o.value = v;
        o.textContent = v;
        sel.append(o);
      });
    }

    // 4. Update dependent dropdowns on change
    countrySel.onchange = () => {
      const f1 = dataRows.filter(r => r['Country\'s Name, the player belongs to ✅'] === countrySel.value);
      populateDropdown(provSel, getUnique(f1, 'Province/State\'s Name, the player belongs to ✅'));
      clearDropdown(distSel); clearDropdown(tehSel);
    };

    provSel.onchange = () => {
      const f2 = dataRows.filter(r =>
        r['Country\'s Name, the player belongs to ✅'] === countrySel.value &&
        r['Province/State\'s Name, the player belongs to ✅'] === provSel.value
      );
      populateDropdown(distSel, getUnique(f2, 'District Name ✅'));
      clearDropdown(tehSel);
    };

    distSel.onchange = () => {
      const f3 = dataRows.filter(r =>
        r['Country\'s Name, the player belongs to ✅'] === countrySel.value &&
        r['Province/State\'s Name, the player belongs to ✅'] === provSel.value &&
        r['District Name ✅'] === distSel.value
      );
      populateDropdown(tehSel, getUnique(f3, 'Tehsil Name ✅'));
    };

    function clearDropdown(sel) {
      sel.innerHTML = '<option value="">-- Select --</option>';
    }

    // 5. Search and display teams
    searchBtn.onclick = () => {
      const filtered = dataRows.filter(r =>
        r['Country\'s Name, the player belongs to ✅'] === countrySel.value &&
        r['Province/State\'s Name, the player belongs to ✅'] === provSel.value &&
        r['District Name ✅'] === distSel.value &&
        r['Tehsil Name ✅'] === tehSel.value &&
        r['Player of the Sports'] === 'Football'
      );
      const teams = getUnique(filtered, 'Enter the Team name');
      teamsList.innerHTML = teams.sort().map(t => `<li>${t}</li>`).join('');
    };
  </script>
</body>
</html>
